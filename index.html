<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>VinMonDice – Swap & Dice on Monad</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta
    name="description"
    content="VinMonDice dApp on Monad: Swap VIN ↔ MON at 1:1, play on-chain Dice with VIN, and see real-time VIN/USD price."
  />
  <meta name="theme-color" content="#020617" />

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="logo128.png" />

  <!-- Main stylesheet -->
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="app-root">
    <!-- Header / Navigation -->
    <header class="header">
      <div class="header-inner">
        <div class="brand">
          <img src="logo128.png" alt="VIN Logo" class="brand-logo" />
          <div class="brand-text">
            <div class="brand-title">VinMonDice</div>
            <div class="brand-subtitle">Swap • Dice • On Monad</div>
          </div>
        </div>

        <div class="nav-center">
          <nav class="nav-links">
            <button class="nav-link active" id="navHome">Home</button>
            <button class="nav-link" id="navSwap">Swap</button>
            <button class="nav-link" id="navDice">Dice</button>
          </nav>
        </div>

        <div class="nav-right">
          <div class="price-chip">
            <span class="price-label">1 VIN ≈</span>
            <span class="price-value" id="navVinPriceUsd">Loading...</span>
          </div>
          <button class="btn-connect" id="connectWalletButton">
            <span id="connectWalletLabel">Connect Wallet</span>
          </button>
        </div>
      </div>
    </header>

    <!-- Main container -->
    <main class="main">
      <!-- HOME SCREEN -->
      <section class="screen screen-active" id="home-screen">
        <div class="home-layout">
          <!-- Left: Hero / Intro -->
          <div class="home-hero">
            <h1 class="hero-title">
              VinMonDice on Monad
            </h1>
            <p class="hero-subtitle">
              Swap VIN ↔ MON at a fixed 1:1 rate and play fully on-chain Dice
              using VIN. Transparent, simple, and gas-efficient on Monad.
            </p>

            <div class="hero-actions">
              <button class="btn btn-primary" id="goToSwap">
                Swap VIN / MON
              </button>
              <button class="btn btn-secondary" id="goToDice">
                Play Dice
              </button>
            </div>

            <div class="hero-wallet">
              <div class="status-row">
                <span class="status-label">Wallet:</span>
                <span class="status-value" id="homeWalletAddress">Not connected</span>
              </div>
              <div class="status-row">
                <span class="status-label">VIN Balance:</span>
                <span class="status-value" id="homeVinBalance">-</span>
              </div>
              <div class="status-row">
                <span class="status-label">MON Balance:</span>
                <span class="status-value" id="homeMonBalance">-</span>
              </div>
              <div class="status-row">
                <span class="status-label">Dice Pool VIN:</span>
                <span class="status-value" id="homeDicePoolVin">Loading...</span>
              </div>
              <div class="status-row">
                <span class="status-label">Network:</span>
                <span class="status-value" id="homeNetwork">Unknown</span>
              </div>
            </div>
          </div>

          <!-- Right: Tokenomics / Info -->
          <div class="home-info">
            <div class="info-card">
              <h2>What is VIN?</h2>
              <p>
                VIN is a fixed-supply ERC20-style token on Monad, designed as
                the main asset of the VinMonDice ecosystem. It is fully
                on-chain, with transparent tokenomics and immutable contracts.
              </p>
              <ul class="info-list">
                <li>
                  <strong>Chain:</strong> Monad (chainId 143)
                </li>
                <li>
                  <strong>Token address:</strong>
                  <a
                    href="https://monadvision.com/token/0xfB71cbd8CB6f0fb72a9568f11e7E4454309A9cA1"
                    target="_blank"
                    rel="noopener noreferrer"
                  >
                    View on MonadVision
                  </a>
                </li>
                <li>
                  <strong>Decimals:</strong> 18
                </li>
                <li>
                  <strong>Use case:</strong> Swap with MON and play Dice.
                </li>
              </ul>
            </div>

            <div class="info-card">
              <h2>Token Allocation</h2>
              <p>
                The VIN supply is transparently split between a Swap pool and a
                Dice reward pool.
              </p>
              <ul class="info-list">
                <li>
                  <strong>Swap pool:</strong> 50,000,000 VIN
                </li>
                <li>
                  <strong>Dice pool:</strong> 50,000,000 VIN
                </li>
                <li>
                  100,000,000 VIN are permanently allocated: 50,000,000 VIN to the
                  Swap contract and 50,000,000 VIN to the Dice contract.
                </li>
                <li>
                  No developer withdrawal from these pools; they are strictly
                  used to serve users.
                </li>
              </ul>
            </div>

            <div class="info-card">
              <h2>How It Works</h2>
              <ol class="info-list numbered">
                <li>
                  Swap MON → VIN at a fixed 1:1 rate as long as the Swap pool
                  has enough liquidity.
                </li>
                <li>
                  Use VIN to play the on-chain Dice game with transparent rules
                  and verifiable results.
                </li>
                <li>
                  All logic and payouts are handled by smart contracts on Monad,
                  with no backdoor withdrawal of pool funds.
                </li>
              </ol>
            </div>
          </div>
        </div>

        <!-- Roadmap / Concept section -->
        <section class="roadmap">
          <div class="roadmap-inner">
            <h2 class="roadmap-title">VIN Lifecycle</h2>
            <p class="roadmap-intro">
              VIN starts fully collateralized by MON in the Swap pool and
              gradually becomes an independent asset as players win VIN from
              the Dice pool.
            </p>

            <div class="roadmap-steps">
              <div class="roadmap-step">
                <div class="roadmap-step-number">1</div>
                <div class="roadmap-step-body">
                  <h3>Launch Phase</h3>
                  <ul>
                    <li>
                      Total supply: <strong>100,000,000 VIN</strong>.
                    </li>
                    <li>
                      <strong>50,000,000 VIN</strong> locked in the Swap contract
                      with MON.
                    </li>
                    <li>
                      <strong>50,000,000 VIN</strong> locked in the Dice contract
                      as a reward pool.
                    </li>
                  </ul>
                </div>
              </div>

              <div class="roadmap-step">
                <div class="roadmap-step-number">2</div>
                <div class="roadmap-step-body">
                  <h3>Growth Phase</h3>
                  <ul>
                    <li>Players swap MON for VIN and start playing Dice.</li>
                    <li>
                      Some VIN moves from the Swap contract to user wallets,
                      while some VIN moves from the Dice contract to the winners.
                    </li>
                    <li>
                      Over time, VIN is spread across more wallets, increasing
                      decentralization.
                    </li>
                  </ul>
                </div>
              </div>

              <div class="roadmap-step">
                <div class="roadmap-step-number">3</div>
                <div class="roadmap-step-body">
                  <h3>Independent Asset Phase</h3>
                  <ul>
                    <li>
                      If a large portion of VIN leaves the Swap contract, the
                      1:1 rate eventually stops once the pool is empty.
                    </li>
                    <li>
                      VIN becomes an <strong>independent asset</strong>, no longer
                      strictly tied to MON.
                    </li>
                    <li>
                      Holders can trade, provide liquidity, and build new products
                      around VIN.
                    </li>
                  </ul>
                </div>
              </div>
            </div>

            <div class="roadmap-footer">
              <p class="roadmap-tagline">
                <strong>Got MON? Get VIN.</strong>
              </p>
            </div>
          </div>
        </section>
      </section>

      <!-- SWAP SCREEN -->
      <section class="screen" id="swap-screen">
        <div class="screen-header">
          <h1>Swap VIN ↔ MON</h1>
          <p class="screen-subtitle">
            Fixed 1:1 rate between VIN (ERC20) and MON (native) on Monad.
          </p>
        </div>

        <div class="swap-layout">
          <div class="swap-card">
            <div class="swap-card-header">
              <h2>Swap</h2>
              <div class="swap-tabs">
                <button class="swap-tab active" id="tabVinToMon">VIN → MON</button>
                <button class="swap-tab" id="tabMonToVin">MON → VIN</button>
              </div>
            </div>

            <div class="swap-body">
              <div class="swap-input-group">
                <div class="swap-input-header">
                  <span class="swap-input-label">From</span>
                  <span class="swap-input-balance" id="fromBalanceLabel">
                    Balance: -
                  </span>
                </div>
                <div class="swap-input-row">
                  <input
                    type="text"
                    inputmode="decimal"
                    id="swapFromAmount"
                    class="swap-input"
                    placeholder="0.0"
                  />
                  <button class="btn-max" id="swapMaxButton">MAX</button>
                  <div class="swap-token-badge" id="swapFromToken">VIN</div>
                </div>
              </div>

              <div class="swap-arrow-row">
                <div class="swap-arrow">
                  <span>⇅</span>
                </div>
              </div>

              <div class="swap-input-group">
                <div class="swap-input-header">
                  <span class="swap-input-label">To</span>
                  <span class="swap-input-balance" id="toBalanceLabel">
                    Balance: -
                  </span>
                </div>
                <div class="swap-input-row">
                  <input
                    type="text"
                    inputmode="decimal"
                    id="swapToAmount"
                    class="swap-input"
                    placeholder="0.0"
                    readonly
                  />
                  <div class="swap-token-badge" id="swapToToken">MON</div>
                </div>
              </div>

              <div class="swap-rate-row">
                <span id="swapRateLabel">
                  1 VIN = 1 MON (fixed while pool has liquidity)
                </span>
              </div>
            </div>

            <div class="swap-footer">
              <button class="btn btn-primary btn-swap-action" id="swapActionButton">
                Swap
              </button>
              <div class="tx-status" id="swapStatus">
                Enter an amount to swap.
              </div>
            </div>
          </div>

          <div class="swap-info-card">
            <h2>Swap Contract</h2>
            <p>
              The Swap contract holds MON and VIN in a fixed 1:1 ratio. As long
              as there is enough liquidity on the chosen side, you can swap
              freely:
            </p>
            <ul class="info-list">
              <li>Swap VIN → MON when the MON pool is not empty.</li>
              <li>Swap MON → VIN when the VIN pool is not empty.</li>
              <li>No extra protocol fee is charged by the contract.</li>
            </ul>
            <p class="info-note">
              All swaps happen fully on-chain. The contract has no admin keys to
              withdraw the underlying pools.
            </p>
            <p class="info-note">
              Make sure you are connected to Monad (chainId 143) in MetaMask or
              your preferred wallet before swapping.
            </p>
          </div>
        </div>
      </section>

      <!-- DICE SCREEN -->
      <section class="screen" id="dice-screen">
        <div class="screen-header">
          <h1>Play VIN Dice</h1>
          <p class="screen-subtitle">
            Guess Even or Odd and win 2x your bet if you are right.
            Results are fully on-chain and verifiable on Monad.
          </p>
        </div>

        <div class="dice-layout">
          <!-- Left: Play area -->
          <div class="dice-card dice-card-left">
            <!-- Wallet summary -->
            <div class="dice-section">
              <h2>Your Wallet</h2>
              <div class="status-row">
                <span class="status-label">Wallet:</span>
                <span class="status-value" id="diceWalletAddressShort">
                  Not connected
                </span>
              </div>
              <div class="status-row">
                <span class="status-label">VIN Balance:</span>
                <span class="status-value" id="diceVinBalance">-</span>
              </div>
              <div class="status-row">
                <span class="status-label">MON Balance:</span>
                <span class="status-value" id="diceMonBalance">-</span>
              </div>
              <div class="status-row">
                <span class="status-label">Dice Allowance:</span>
                <span class="status-value" id="diceAllowance">-</span>
              </div>
              <div class="status-row">
                <span class="status-label">Reward Pool (VIN):</span>
                <span class="status-value" id="dicePoolVin">Loading...</span>
              </div>
              <p class="dice-note" id="diceMinInfo">
                Minimum bet: loading...
              </p>
            </div>

            <!-- Approval -->
            <div class="dice-section">
              <h2>Approval</h2>
              <p class="dice-note">
                Before playing, you must approve VIN for the Dice contract once.
                The dApp will approve a large amount (for example 100,000,000 VIN)
                so you do not need to approve every bet. You can always reduce
                allowance later from your wallet.
              </p>
              <button class="btn btn-primary btn-full" id="diceApproveButton">
                Approve VIN for Dice
              </button>
            </div>
          </div>

          <!-- Right: Betting & result -->
          <div class="dice-card dice-card-right">
            <!-- Bet input -->
            <div class="dice-section">
              <h2>Place Your Bet</h2>
              <label class="dice-label" for="diceBetAmount">Bet Amount (VIN)</label>
              <div class="dice-input-row">
                <input
                  type="text"
                  inputmode="decimal"
                  id="diceBetAmount"
                  class="dice-input"
                  placeholder="0.0"
                  value="0.000001"
                />
                <button class="btn-max" id="diceMaxButton">MAX</button>
              </div>
              <div class="dice-minimum-line" id="diceMinimumText">
                Minimum bet: 0.000001 VIN. No hard maximum bet.
              </div>
            </div>

            <!-- Guess buttons -->
            <div class="dice-section">
              <h2>Choose your guess</h2>
              <div class="dice-guess-buttons">
                <button
                  class="btn-guess btn-guess-even active"
                  id="diceGuessEven"
                >
                  EVEN
                </button>
                <button class="btn-guess btn-guess-odd" id="diceGuessOdd">
                  ODD
                </button>
              </div>
            </div>

            <!-- Visual -->
            <div class="dice-section">
              <div class="dice-visual" id="diceVisual">
                <div class="dice-orb"></div>
                <div class="dice-coins">
                  <span class="dice-coin dice-coin-white"></span>
                  <span class="dice-coin dice-coin-red"></span>
                  <span class="dice-coin dice-coin-white"></span>
                  <span class="dice-coin dice-coin-red"></span>
                </div>
              </div>
              <p class="dice-note">
                The 4 coins are a visual effect. The real Even/Odd result is
                computed on-chain from block data.
              </p>
            </div>

            <!-- Play button & status -->
            <div class="dice-section">
              <button class="btn btn-primary btn-full" id="dicePlayButton">
                Play Dice
              </button>
              <div class="tx-status" id="diceStatus">
                Enter a bet amount, choose EVEN or ODD, then click "Play Dice".
              </div>
            </div>

            <!-- Last result -->
            <div class="dice-section">
              <h2>Last Result</h2>
              <div class="dice-last-result">
                <div class="dice-last-row">
                  <span class="dice-last-label">Your bet:</span>
                  <span class="dice-last-value" id="diceLastResult">-</span>
                </div>
                <div class="dice-last-row">
                  <span class="dice-last-label">Outcome:</span>
                  <span class="dice-last-value" id="diceLastOutcome">-</span>
                </div>
                <div class="dice-last-row">
                  <span class="dice-last-label">Win / Loss:</span>
                  <span class="dice-last-value" id="diceLastWinLoss">-</span>
                </div>
                <div class="dice-last-row">
                  <span class="dice-last-label">Payout:</span>
                  <span class="dice-last-value" id="diceLastPayout">-</span>
                </div>
                <div class="dice-last-row">
                  <span class="dice-last-label">Tx Hash:</span>
                  <span class="dice-last-value" id="diceLastTx">-</span>
                </div>
              </div>
              <button class="btn btn-secondary btn-full" id="diceRefreshLast">
                Refresh Last Result
              </button>
              <p class="dice-note">
                All game results are on-chain. You can verify them through the
                Monad block explorer using your wallet address and transaction hashes.
              </p>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
      <div class="footer-main">
        <span>© 2025 VinMonDice</span>
        <span class="footer-dot">•</span>
        <a
          href="https://monadvision.com/token/0xfB71cbd8CB6f0fb72a9568f11e7E4454309A9cA1"
          target="_blank"
          rel="noopener noreferrer"
        >
          VIN Token Contract
        </a>
        <span class="footer-dot">•</span>
        <a
          href="https://monadvision.com/address/0x11395DB7E0AcB7c56fE79FBAFFD48B5BeC896098"
          target="_blank"
          rel="noopener noreferrer"
        >
          Swap Contract
        </a>
        <span class="footer-dot">•</span>
        <a
          href="https://monadvision.com/address/0x245Fb6ECC6B2beCaf45AC15E4fAc8C78826f0F67"
          target="_blank"
          rel="noopener noreferrer"
        >
          Dice Contract
        </a>
      </div>
      <div class="footer-sub">
        <span>VIN is an experimental on-chain asset. Use at your own risk.</span>
      </div>
    </footer>
  </div>

  <!-- VIN price (USD) from MON/USDT via CoinGecko -->
  <script>
    async function fetchVinPriceUsd() {
      const label = document.getElementById("navVinPriceUsd");
      if (!label) return;

      try {
        label.textContent = "Loading...";

        const res = await fetch(
          "https://api.coingecko.com/api/v3/simple/price?ids=monad&vs_currencies=usd"
        );

        if (!res.ok) {
          throw new Error("HTTP " + res.status);
        }

        const data = await res.json();
        const monPrice = data && data.monad && data.monad.usd;

        if (typeof monPrice === "number" && isFinite(monPrice) && monPrice > 0) {
          const vinPrice = monPrice; // 1 VIN = 1 MON while the pool is active
          label.textContent = vinPrice.toFixed(4) + " USD";
        } else {
          label.textContent = "N/A";
        }
      } catch (err) {
        console.error("Error fetching VIN price (via MON):", err);
        label.textContent = "N/A";
      }
    }

    fetchVinPriceUsd();
    setInterval(fetchVinPriceUsd, 60000);
  </script>

  <!-- Ethers.js (v5) and main dApp logic -->
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <script src="app.js"></script>
</body>
</html>
